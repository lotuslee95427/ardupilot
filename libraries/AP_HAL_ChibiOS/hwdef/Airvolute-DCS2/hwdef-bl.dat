# 这是Airvolute-DCS2飞控板的bootloader硬件定义文件
# 该文件由chibios_hwdef.py脚本处理,用于配置STM32H743芯片的硬件引脚和外设

# 定义MCU类型为STM32H7系列,具体型号为STM32H743
MCU STM32H7xx STM32H743xx

# 外部晶振频率为16MHz
OSCILLATOR_HZ 16000000

# 开发板ID为5200,用于固件校验和加载
APJ_BOARD_ID 5200

# Flash总容量为2048KB(Nucleo开发板在刷写最后一个扇区时可能有问题)
FLASH_SIZE_KB 2048

# bootloader从Flash起始位置(0偏移)安装
FLASH_RESERVE_START_KB 0

# bootloader将固件加载到Flash 128KB处
# STM32H743的Flash扇区大小为128KB
FLASH_BOOTLOADER_LOAD_KB 128

# USB设备制造商名称设置
USB_STRING_MANUFACTURER "Airvolute"

# bootloader串口通信波特率设置为115200
define BOOTLOADER_BAUDRATE 115200

# 配置串口顺序:USB OTG1和USART1
SERIAL_ORDER OTG1 USART1

# USB连接检测引脚配置
# PA9配置为漏极开路输入,用于检测USB连接状态
PA9 VBUS INPUT OPENDRAIN

# UART1串口配置(SE连接器)
PB14 USART1_TX USART1    # UART1发送引脚
PA10 USART1_RX USART1    # UART1接收引脚

# bootloader指示LED配置,使用PB1引脚,低电平输出
PB1 LED_BOOTLOADER OUTPUT LOW
define HAL_LED_ON 1

# 启用串口功能
define HAL_USE_SERIAL TRUE

# USB OTG接口配置
PA11 OTG_FS_DM OTG1      # USB D-引脚
PA12 OTG_FS_DP OTG1      # USB D+引脚

# SWD调试接口配置
PA13 JTMS-SWDIO SWD      # SWDIO数据线
PA14 JTCK-SWCLK SWD      # SWCLK时钟线

# 配置各传感器和外设的片选(CS)引脚,确保在bootloader中保持高电平
PD12 IMU_CS0 CS          # IMU传感器0片选
PE13 IMU_CS1 CS          # IMU传感器1片选
PD13 BARO_CS CS          # 气压计片选
PD15 EXT_0 CS            # 外部设备0片选
PD14 EXT_1 CS            # 外部设备1片选
PD11 EXT_2 CS            # 外部设备2片选
PD10 EXT_3 CS            # 外部设备3片选
